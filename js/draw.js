function loadJSON(t){var a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET","js/price_btc.json",!0),a.onreadystatechange=function(){4==a.readyState&&"200"==a.status&&t(a.responseText)},a.send(null)}loadJSON(function(t){console.log("hi");let a=JSON.parse(t),r=0;console.log("start?");var e,n,i,c,o,l,s,d,p={top:10,right:8,bottom:20,left:8},h=90,y=1e3;function u(){r++;var t=new Object;t.y=a[r].price,s.push(t),d.push(t.y),x(s,d)}function x(t,a){let r=c(t.length-1)/$("#svgGraph").width();console.log("divde :",r);for(var s=new Array,d=new Array,p=0;p<t.length-1;p++)s.push(t[p]),p==t.length-2&&d.push(t[p]);d.push(t[t.length-1]),d3.selectAll(".newChart").remove();var u=Math.max.apply(null,a),x=Math.min.apply(null,a),g=(u-x)/9;u+=1.1*g,x-=2.3*g,o=d3.scaleLinear().domain([x,u]).range([n,0]),i.append("g").attr("class","y axis newChart").call(d3.axisLeft(o)).selectAll(".tick text").attr("x",c(89)).attr("dy",0),i.append("g").attr("class","grid newChart").call(d3.axisLeft(o).ticks(6).tickSize(-e).tickFormat(""));var f=d3.line().x(function(t,a){return c(a)}).y(function(t){return o(t.y)}).curve(d3.curveLinear),w=d3.area().x(function(t,a){return c(a)}).y0(function(t){return o(x)}).y1(function(t){return o(t.y)}).curve(d3.curveLinear);if(i.append("path").attr("class","priceLine newChart").attr("d",f(s)),i.append("path").attr("id","pathNewChart").attr("class","priceArea newChart").attr("d",w(s)),t.length>1){var m=c(t.length-2),v=c(t.length-1),C=o(t[t.length-2].y),A=o(t[t.length-1].y);i.append("line").attr("class","priceLineNew newChart").attr("x1",m).attr("y1",C).attr("x2",m).attr("y2",C).transition().duration(y).attr("x2",v).attr("y2",A);var L=[{x:m,y:o(x)},{x:m,y:C},{x:m,y:C},{x:m,y:o(x)}],b=[{x:m,y:o(x)},{x:m,y:C},{x:v,y:A},{x:v,y:o(x)}];i.append("polygon").attr("class","priceArea newChart").data([L]).attr("points",function(t){return t.map(function(t){return[t.x,t.y].join(",")}).join(" ")}),d3.selectAll("polygon").data([b]).transition().duration(y).attr("points",function(t){return t.map(function(t){return[t.x,t.y].join(",")}).join(" ")}),i.append("line").attr("class","cLine newChart").attr("x1",c(0)).attr("y1",C).attr("x2",c(h)).attr("y2",C).transition().duration(y).attr("x1",c(0)).attr("y1",A).attr("x2",c(h)).attr("y2",A),i.append("text").attr("class","priceText newChart").attr("x",c(60)).attr("y",C).text(d3.format(",")(l)).transition().duration(y).attr("y",A).text(d3.format(",")(l));var j=5;window.innerWidth>window.innerHeight&&(j*=1.5),i.append("circle").attr("class","priceCircle newChart").attr("r",j).attr("cx",c(t.length-2)).attr("cy",C).transition().duration(y).attr("r",.9*j).attr("cx",c(t.length-1)).attr("cy",A),i.append("circle").attr("class","priceCircleEffect newChart").attr("r",1.3*j).attr("cx",c(t.length-2)).attr("cy",C).transition().duration(y).attr("r",2*j).attr("cx",c(t.length-1)).attr("cy",A)}}e=$("#divGraph").outerWidth()-10,n=window.innerHeight-52-p.top-p.bottom,i=d3.select("#svgGraph").attr("width",e+p.left+p.right).attr("height",n+p.top+p.bottom).append("g").attr("transform","translate("+p.left+","+p.top+")").call(d3.zoom().on("zoom",function(){i.attr("transform",d3.event.transform)})),c=d3.scaleLinear().domain([0,h]).range([0,e]),d3.selectAll(".initChart").remove(),i.append("rect").attr("class","b1Area initChart").attr("x",c(0)).attr("y",0).attr("width",e/9*2).attr("height",n),i.append("rect").attr("class","b2Area initChart").attr("x",c(20)).attr("y",0).attr("width",e/9*2).attr("height",n),i.append("rect").attr("class","b3Area initChart").attr("x",c(40)).attr("y",0).attr("width",e/9*2).attr("height",n),i.append("rect").attr("width","100%").attr("height","100%").attr("fill","#202736"),i.append("rect").attr("class","endArea initChart").attr("x",c(60)).attr("y",0).attr("width",e/3).attr("height",n),i.append("g").attr("class","x axis initChart").attr("transform","translate(0,"+n+")").call(d3.axisBottom(c)),i.append("g").attr("class","grid initChart").attr("transform","translate(0,"+n+")").call(d3.axisBottom(c).ticks(9).tickSize(-n).tickFormat("")),function(){for(s=new Array,d=new Array;r<10;r++){var t=new Object;t.y=a[r].price,s.push(t),d.push(t.y),l=t.y}x(s,d)}(),document.getElementById("newdata").addEventListener("click",u),document.getElementById("newdata10").addEventListener("click",function(){for(let t=0;t<10;t++)u()})});